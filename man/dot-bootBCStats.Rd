% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{.bootBCStats}
\alias{.bootBCStats}
\title{Differential connectivity bootstrap statistics (bias-corrected)}
\usage{
.bootBCStats(mi, pi, CI = 0.95)
}
\arguments{
\item{mi}{Numeric scalar. The observed measure/statistic.}

\item{pi}{Numeric vector. The null/sampling distribution (e.g., from
permutation or bootstrap). \code{NA}s are removed.}

\item{CI}{Numeric in (0,1). Confidence level for the interval. Default 0.95.}
}
\value{
A one-row \code{data.frame} with columns:
\itemize{
  \item \code{test_dir}: "Up" if \code{mi > 0} else "Down"
  \item \code{z}: signed z-score aligned with \code{mi}
  \item \code{pval}: two-sided p-value
  \item \code{fdr}: Benjaminiâ€“Hochberg adjusted p-value (computed on the returned row)
  \item \code{ci_low}, \code{ci_high}: confidence interval bounds at level \code{conf}
}
}
\description{
Computes a two-sided p-value and confidence interval for a statistic \code{mi}
against its null distribution \code{pi}. Internally uses a bias-corrected
mapping on the null via \eqn{z_0} and finds the calibration \eqn{z_A} by
minimizing a CI width criterion (Brent's method).
}
\details{
Let \eqn{\hat{F}} be the empirical CDF of \code{pi}. Define
\deqn{ z_0 = \mathrm{sign}(-\mathbb{E}[pi - mi]) \cdot \left| \Phi^{-1}\{\hat{F}(mi)\} \right|, }
and find \eqn{z_A} that minimizes the CI width induced by the transformed
quantiles \eqn{\Phi(2 z_0 \pm z_A)}. The two-sided p-value is
\eqn{2 \Phi(-|z_A|)} and the (\code{conf})-level CI uses
\eqn{z_\alpha = \Phi^{-1}(\alpha)} with \eqn{\alpha = (1 - \mathrm{conf})/2}.
}
\keyword{internal}
